# Aider Automation 配置指南

## 📋 配置文件说明

配置文件 `.aider-automation.json` 已经为你创建好了。下面是详细的配置说明：

## 🔧 必须修改的配置

### 1. GitHub 仓库信息
```json
{
  "github": {
    "token": "${GITHUB_TOKEN}",
    "repo": "owner/repository-name"  // ← 必须修改这里
  }
}
```

**修改步骤：**
1. 将 `owner/repository-name` 替换为你的 GitHub 仓库
   - 例如：`"zyqfork/my-project"`
   - 格式：`"用户名/仓库名"`

### 2. GitHub Token 设置

**方法一：使用环境变量（推荐）**
```bash
# 在终端中设置（临时）
export GITHUB_TOKEN="ghp_xxxxxxxxxxxxxxxxxxxx"

# 或添加到 ~/.zshrc 文件中（永久）
echo 'export GITHUB_TOKEN="ghp_xxxxxxxxxxxxxxxxxxxx"' >> ~/.zshrc
source ~/.zshrc
```

**方法二：直接在配置文件中设置**
```json
{
  "github": {
    "token": "ghp_xxxxxxxxxxxxxxxxxxxx",  // 直接填写你的 token
    "repo": "zyqfork/my-project"
  }
}
```

## 🎯 如何获取 GitHub Token

1. 访问 GitHub 设置页面：https://github.com/settings/tokens
2. 点击 "Generate new token" → "Generate new token (classic)"
3. 设置 Token 名称，例如：`aider-automation`
4. 选择权限范围，**必须勾选**：
   - ✅ `repo` (完整仓库访问权限)
   - ✅ `workflow` (如果需要修改 GitHub Actions)
5. 点击 "Generate token"
6. **重要**：复制生成的 token（以 `ghp_` 开头），保存好，页面刷新后就看不到了

## ⚙️ 可选配置项

### Aider 设置
```json
{
  "aider": {
    "options": ["--no-pretty", "--yes"],  // aider 命令行选项
    "model": "gpt-4"                      // AI 模型，可选：gpt-4, gpt-3.5-turbo, claude-3-sonnet 等
  }
}
```

### Git 设置
```json
{
  "git": {
    "default_branch": "main",              // 默认分支，通常是 main 或 master
    "branch_prefix": "aider-automation/"   // 自动创建的分支前缀
  }
}
```

### 模板设置（高级用户）
```json
{
  "templates": {
    "commit_message": "feat: {summary}",                    // 提交信息模板
    "pr_title": "AI-generated changes: {summary}",         // PR 标题模板
    "pr_body": "## 自动生成的更改\n\n**提示词：** {prompt}\n\n**修改的文件：**\n{modified_files}\n\n**Aider 摘要：**\n{aider_summary}"
  }
}
```

## 📝 配置示例

### 示例 1：基本配置
```json
{
  "github": {
    "token": "${GITHUB_TOKEN}",
    "repo": "zyqfork/my-awesome-project"
  },
  "aider": {
    "options": ["--no-pretty", "--yes"],
    "model": "gpt-4"
  },
  "git": {
    "default_branch": "main",
    "branch_prefix": "ai-changes/"
  }
}
```

### 示例 2：使用不同 AI 模型
```json
{
  "github": {
    "token": "${GITHUB_TOKEN}",
    "repo": "zyqfork/my-project"
  },
  "aider": {
    "options": ["--no-pretty", "--yes"],
    "model": "claude-3-sonnet"
  }
}
```

## 🚀 快速开始步骤

1. **修改配置文件**
   ```bash
   # 编辑配置文件
   code .aider-automation.json  # 使用 VS Code
   # 或
   nano .aider-automation.json  # 使用 nano 编辑器
   ```

2. **设置 GitHub Token**
   ```bash
   export GITHUB_TOKEN="你的_github_token"
   ```

3. **检查配置**
   ```bash
   source venv/bin/activate
   python -m aider_automation.main --check
   ```

4. **测试运行**
   ```bash
   python -m aider_automation.main "添加一个简单的 hello world 函数"
   ```

## ❗ 常见问题

### Q: 我的仓库名称是什么？
A: 在 GitHub 上打开你的仓库，URL 格式是 `https://github.com/用户名/仓库名`
   例如：`https://github.com/zyqfork/my-project` → 配置为 `"zyqfork/my-project"`

### Q: 如何知道我的默认分支？
A: 在 GitHub 仓库页面可以看到，通常是 `main` 或 `master`

### Q: Token 权限不够怎么办？
A: 确保 token 有 `repo` 权限，如果是私有仓库还需要相应权限

### Q: 如何测试配置是否正确？
A: 运行 `python -m aider_automation.main --check` 命令

## 🔒 安全提示

1. **不要将 GitHub Token 直接写在配置文件中并提交到 Git**
2. **使用环境变量是最安全的方式**
3. **定期更换 GitHub Token**
4. **不要分享你的 Token 给其他人**

---

修改完配置文件后，你就可以开始使用 aider-automation 了！