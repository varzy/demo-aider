# 📖 Aider Automation 使用说明

## 🎯 项目简介

Aider Automation 是一个自动化工具，它可以：
1. 接收你的自然语言提示词
2. 使用 AI (aider) 修改你的代码
3. 自动提交更改到 Git
4. 自动创建 GitHub Pull Request

**一句话总结：用自然语言描述你想要的功能，AI 帮你实现并自动创建 PR！**

## 🚀 现在开始使用

### 方法一：使用设置向导（推荐新手）

```bash
# 1. 激活环境
source venv/bin/activate

# 2. 运行设置向导
python setup.py

# 3. 检查配置
python scripts/check_setup.py

# 4. 开始使用
python -m aider_automation.main "添加一个 hello world 函数"
```

### 方法二：手动配置（适合有经验的用户）

1. **编辑配置文件**
   ```bash
   code .aider-automation.json
   ```

   修改其中的 `"repo": "owner/repository-name"` 为你的实际仓库。

2. **设置 GitHub Token**
   ```bash
   export GITHUB_TOKEN="你的_github_token"
   ```

3. **开始使用**
   ```bash
   python -m aider_automation.main "你的提示词"
   ```

## 📋 你需要准备的信息

### 1. GitHub 仓库信息
- **格式**：`用户名/仓库名`
- **示例**：`zyqfork/my-project`
- **获取方式**：在 GitHub 上打开你的仓库，URL 中就有这个信息

### 2. GitHub Token
- **用途**：让程序能够访问你的 GitHub 仓库和创建 PR
- **获取步骤**：
  1. 访问 https://github.com/settings/tokens
  2. 点击 "Generate new token (classic)"
  3. 勾选 `repo` 权限
  4. 复制生成的 token（以 `ghp_` 开头）

## 💡 使用示例

### 基础功能开发
```bash
# 添加新功能
python -m aider_automation.main "添加用户注册功能"

# 添加数据库模型
python -m aider_automation.main "创建用户表的数据库模型"

# 添加 API 接口
python -m aider_automation.main "添加获取用户信息的 API 接口"
```

### Bug 修复
```bash
# 修复样式问题
python -m aider_automation.main "修复登录页面按钮样式错乱的问题"

# 修复逻辑错误
python -m aider_automation.main "修复用户密码验证逻辑错误"

# 性能优化
python -m aider_automation.main "优化数据库查询性能，减少 N+1 查询"
```

### 代码重构
```bash
# 重构代码结构
python -m aider_automation.main "重构用户服务代码，提高可读性"

# 添加测试
python -m aider_automation.main "为用户服务添加单元测试"

# 更新文档
python -m aider_automation.main "更新 API 文档，添加新接口说明"
```

## 🔧 高级选项

### 指定分支名称
```bash
python -m aider_automation.main "添加支付功能" --branch payment-feature
```

### 启用详细输出
```bash
python -m aider_automation.main "修复 bug" --verbose
```

### 保存日志文件
```bash
python -m aider_automation.main "重构代码" --log-file refactor.log
```

### 使用自定义配置
```bash
python -m aider_automation.main "添加功能" --config my-config.json
```

## 🛠️ 工具命令

### 环境检查
```bash
python -m aider_automation.main --check
```
检查所有依赖项和配置是否正确。

### 创建配置文件
```bash
python -m aider_automation.main --init
```
创建默认的配置文件。

### 查看帮助
```bash
python -m aider_automation.main --help
```
显示所有可用选项和使用说明。

## 📊 工作流程

当你运行命令后，程序会自动执行以下步骤：

1. **🔍 环境检查** - 验证 aider、Git、GitHub 访问权限
2. **🌿 分支管理** - 创建新分支（基于提示词自动命名）
3. **🤖 AI 代码修改** - aider 根据你的提示词修改代码
4. **💾 提交更改** - 自动 git add 和 commit
5. **📤 推送分支** - 推送到 GitHub
6. **🔗 创建 PR** - 自动创建 Pull Request

整个过程完全自动化，你只需要等待完成！

## ❗ 常见问题

### Q: 程序卡住不动了？
A: 可能是 aider 在等待 AI 响应，请耐心等待。使用 `--verbose` 可以看到详细进度。

### Q: 提示 "GitHub API 访问失败"？
A: 检查你的 GitHub Token 是否正确设置，是否有足够的权限。

### Q: 提示 "不是 Git 仓库"？
A: 确保你在正确的项目目录中，并且已经初始化了 Git 仓库。

### Q: AI 修改的代码不符合预期？
A: 尝试使用更具体、更清晰的提示词。你也可以在 PR 中手动调整代码。

### Q: 如何撤销操作？
A: 程序会创建新分支，不会影响主分支。你可以直接删除创建的分支和 PR。

## 🎯 最佳实践

### 1. 提示词要具体
❌ 不好：`"改进代码"`
✅ 好：`"重构用户认证模块，提取公共方法，添加错误处理"`

### 2. 一次做一件事
❌ 不好：`"添加用户系统、支付系统和通知系统"`
✅ 好：`"添加用户注册和登录功能"`

### 3. 包含上下文信息
❌ 不好：`"修复 bug"`
✅ 好：`"修复登录页面在 Safari 浏览器中按钮显示异常的问题"`

### 4. 指定技术栈
❌ 不好：`"添加数据库"`
✅ 好：`"使用 SQLAlchemy 添加用户表模型"`

## 🔒 安全提示

1. **不要在配置文件中直接写 GitHub Token**
2. **使用环境变量存储敏感信息**
3. **定期检查和更新 GitHub Token**
4. **审查 AI 生成的代码再合并到主分支**

---

## 🎉 开始你的 AI 编程之旅！

现在你已经了解了如何使用 Aider Automation。记住：
- 从简单的任务开始
- 使用清晰具体的提示词
- 检查 AI 生成的代码
- 享受自动化带来的便利！

**祝你编程愉快！** 🚀